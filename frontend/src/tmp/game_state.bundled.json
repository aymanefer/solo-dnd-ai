{
  "$id": "game_state.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "GameState",
  "type": "object",
  "required": [
    "meta",
    "party",
    "characters",
    "log"
  ],
  "properties": {
    "meta": {
      "type": "object",
      "properties": {
        "campaign_id": {
          "type": "string"
        },
        "turn": {
          "type": "integer"
        },
        "datetime": {
          "type": "string"
        },
        "difficulty": {
          "type": "string",
          "enum": [
            "easy",
            "normal",
            "hard"
          ]
        }
      }
    },
    "party": {
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "characters": {
      "type": "object",
      "additionalProperties": {
        "$ref": "#/properties/npcs/additionalProperties"
      }
    },
    "npcs": {
      "type": "object",
      "additionalProperties": {
        "$id": "character.schema.json",
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "title": "Character",
        "type": "object",
        "required": [
          "id",
          "name",
          "level",
          "class",
          "race",
          "abilities",
          "ac",
          "hp",
          "speed"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique character ID"
          },
          "name": {
            "type": "string"
          },
          "level": {
            "type": "integer",
            "minimum": 1
          },
          "class": {
            "type": "string",
            "enum": [
              "Barbarian",
              "Bard",
              "Cleric",
              "Druid",
              "Fighter",
              "Monk",
              "Paladin",
              "Ranger",
              "Rogue",
              "Sorcerer",
              "Warlock",
              "Wizard"
            ]
          },
          "race": {
            "type": "string",
            "enum": [
              "Human",
              "Elf",
              "Dwarf",
              "Halfling",
              "Dragonborn",
              "Gnome",
              "Half-Elf",
              "Half-Orc",
              "Tiefling"
            ]
          },
          "alignment": {
            "type": "string"
          },
          "abilities": {
            "type": "object",
            "required": [
              "str",
              "dex",
              "con",
              "int",
              "wis",
              "cha"
            ],
            "properties": {
              "str": {
                "type": "integer"
              },
              "dex": {
                "type": "integer"
              },
              "con": {
                "type": "integer"
              },
              "int": {
                "type": "integer"
              },
              "wis": {
                "type": "integer"
              },
              "cha": {
                "type": "integer"
              }
            }
          },
          "proficiencies": {
            "type": "object",
            "properties": {
              "skills": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "saves": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "weapons": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "armor": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "tools": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            }
          },
          "ac": {
            "type": "integer",
            "minimum": 1
          },
          "hp": {
            "type": "object",
            "required": [
              "current",
              "max"
            ],
            "properties": {
              "current": {
                "type": "integer",
                "minimum": 0
              },
              "max": {
                "type": "integer",
                "minimum": 1
              },
              "temp": {
                "type": "integer",
                "minimum": 0
              }
            }
          },
          "speed": {
            "type": "integer",
            "minimum": 0
          },
          "inventory": {
            "type": "array",
            "items": {
              "type": "object"
            }
          },
          "spells": {
            "type": "array",
            "items": {
              "type": "object"
            }
          },
          "features": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "conditions": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "Blinded",
                "Charmed",
                "Deafened",
                "Frightened",
                "Grappled",
                "Incapacitated",
                "Invisible",
                "Paralyzed",
                "Petrified",
                "Poisoned",
                "Prone",
                "Restrained",
                "Stunned",
                "Unconscious",
                "Exhaustion"
              ]
            }
          },
          "resources": {
            "type": "object",
            "additionalProperties": {
              "type": "integer"
            }
          },
          "persona": {
            "type": "object",
            "properties": {
              "voice": {
                "type": "string"
              },
              "goals": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "tactics": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "locations": {
      "type": "object",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "notes": {
            "type": "string"
          }
        }
      }
    },
    "quests": {
      "type": "object",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": [
              "active",
              "completed",
              "failed"
            ]
          },
          "objectives": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      }
    },
    "flags": {
      "type": "object",
      "additionalProperties": {
        "type": "boolean"
      }
    },
    "log": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "t": {
            "type": "integer"
          },
          "type": {
            "type": "string",
            "enum": [
              "ROLL",
              "ACTION",
              "EVENT",
              "NARRATION"
            ]
          },
          "detail": {
            "type": "object"
          }
        }
      }
    }
  }
}